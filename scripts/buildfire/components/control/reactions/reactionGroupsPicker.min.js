if("undefined"==typeof buildfire)throw"please add buildfire.js first to use buildfire components";if(void 0===buildfire.components||void 0===buildfire.components.reactions)throw"please add reactions.js first to use reactionGroupsInput components";void 0===buildfire.components.control&&(buildfire.components.control={}),void 0===buildfire.components.control.tagsInput&&(document.write('<script src="../../../../scripts/buildfire/components/control/tagsInput/tagsInput.min.js"><\/script>'),document.write('<link href="../../../../styles/components/control/tagsInput/tagsInput.min.css" rel="stylesheet"/>')),buildfire.components.control.reactionGroupPicker=(()=>{class e extends buildfire.components.reactions{constructor(e,t={}){super(t),this.selector=e||null,this.placeholder=t.placeholder||"Select Reaction Group",this.groupName=t.groupName||"",buildfire.getContext(((e,t)=>{if(e)return this.onError({code:"_ERROR_CODE_",message:e}),console.error(e);if(t&&"control"==t.type){if(!this.selector)return this.onError({code:"_ERROR_CODE_",message:"Invalid selector"}),console.error("Invalid selector");this._init()}else this.onError({code:"_ERROR_CODE_",message:"reaction dialog should be called in CP-side"}),console.error("reaction dialog should be called in CP-side")}))}_init(){this.groupName&&this._fixGroupName(this.groupName,((e,t)=>{if(e&&this.onError({code:"_ERROR_CODE_",message:e}),!t.existGroupName){let e=document.querySelector(this.selector),t=document.createElement("span");t.className="error",t.innerHTML="Group name is not defined",e.appendChild(t),this.onError({code:"_ERROR_CODE_",message:"group name is not defined"})}}));const t=new buildfire.components.control.tagsInput(this.selector,{languageSettings:{placeholder:this.placeholder},settings:{sourceType:"custom",source:({},t)=>{e.openReactionGroupsDialog({selectedGroup:this.groupName},((e,i)=>{if(e)return this.onError({code:"_ERROR_CODE_",message:e}),console.error(e);i&&t(i)}))},allowAutoComplete:!1,allowUserInput:!1}});t.onUpdate=e=>{e.tags&&e.tags.length?(this.groupName=e.tags[0].name,this.onUpdate({name:this.groupName})):(this.onUpdate({}),this.groupName="")},this.groupName&&t.set([{value:this.groupName,name:this.groupName}])}static openReactionGroupsDialog(e,i){let n={selectedGroup:e.selectedGroup,loading:!0};t.init(n,i)}_registerAnalytics(){[{title:"react",key:"react",desc:"Total reactions"},{title:"unReact",key:"unReact",desc:"Total deleted reactions"}].forEach((e=>buildfire.analytics.registerEvent(e,{silentNotification:!0})))}onUpdate(e={}){return e}onError(e={}){return e}}class t{static dialogContainer=document.createElement("div");static init(e,t){t&&"function"==typeof t||(t=(e,t)=>e?console.error(e):console.log("selected group changed to "+t));let i="boolean"==typeof e.loading&&e.loading,n=e.groups||[],o=e.selectedGroup||"";this.show(),i?(this.updateContentState("loading"),buildfire.components.reactions.getReactionGroups(((e,i)=>{if(e)return console.error(e);this._printList({groups:i,selectedGroup:o}),this._addListeners(i,t)}))):n&&n.length?(this._printList({groups:n,selectedGroup:o}),this._addListeners(n,t)):(this.updateContentState("empty"),this._addListeners(n,t))}static show(){this.dialogContainer.innerHTML='\n            <div modal-render="true" tabindex="-1" role="dialog" class="modal fade ng-isolate-scope in" uib-modal-animation-class="fade" modal-in-class="in" uib-modal-window="modal-window" window-class="" size="lg" index="0" animate="animate" modal-animation="true" style="z-index: 1050; display: block;background:#00000061;">\n                <div class="modal-dialog modal-lg">\n                    <div class="modal-content" uib-modal-transclude="" style="height:70vh;">\n                        <form class="submit-modal">\n                            <div class="tag-search-dialog ng-scope" style="height:70vh;">\n                                <div class="header clearfix border-bottom-grey">\n                                    <h4 class="margin-zero" style="color:#5f5f5f;">Reactions</h4>\n                                    <span class="icon icon-cross2 close-modal" ></span>\n                                </div>\n                                <div class="padded clearfix" style="height: calc(100% - 7.25rem);overflow: hidden;overflow-y: auto;">\n                                    <div class="well no-plugins text-center" id="reactions-dialog-empty-container" style="height: 90%;display: flex;align-items: center;justify-content: center;">\n                                        <h4>Loading...</h4>\n                                    </div>\n                                    <div class="" id="reactions-dialog-list-container">\n                                    </div>\n                                </div>\n                                <div class="bottom border-top-grey clearfix">\n                                    <button class="btn btn-success pull-right margin-left-fifteen save-modal hidden" type="submit">\n                                        Select\n                                    </button>    \n                                    <button class="btn btn-default pull-right cancel-modal border-grey">\n                                        Cancel\n                                    </button>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>',document.body.appendChild(this.dialogContainer)}static hide(){this.dialogContainer.remove()}static updateContentState(e){let t=this.dialogContainer.querySelector("#reactions-dialog-empty-container"),i=this.dialogContainer.querySelector("#reactions-dialog-list-container"),n=this.dialogContainer.querySelector(".save-modal");switch(e){case"empty":t.innerHTML="<div><h4 style='font-size:16px;'>You haven't added any reactions yet</h4><h4 style='font-size:16px;'>You can add Reactions by including Reaction feature from the Marketplace.</h4></div>",t.classList.remove("hidden"),i.classList.add("hidden"),n.classList.add("hidden");break;case"loading":t.innerHTML="<h4 style='font-size:16px;'>Loading...</h4>",t.classList.remove("hidden"),i.classList.add("hidden"),n.classList.add("hidden");break;default:t.classList.add("hidden"),i.classList.remove("hidden"),n.classList.remove("hidden")}}static _printList(e){if(!e||!e.groups||!e.groups.length)return this.updateContentState("empty");let t=this.dialogContainer.querySelector("#reactions-dialog-list-container"),i="";e.groups.forEach(((t,n)=>{let o="";t.reactions.forEach((e=>{let t=buildfire.imageLib.resizeImage(e.selectedUrl,{size:"half_width",aspect:"1:1"});o+=`<img style="width:24px; height:24px;" class="margin-right-five" src="${t}" />`}));let s=!1;e.selectedGroup&&t.name.toLowerCase()==e.selectedGroup.toLowerCase()?s=!0:e.selectedGroup||0!=n||(s=!0);let a=`<tr style="border: 0.5px solid var(--c-gray3);">\n                            <td style="width:0%;" class="padding-bottom-fifteen padding-top-fifteen padding-left-fifteen padding-right-fifteen">\n                                <input ${s?"checked":""} name="selected-reaction-group" type="radio" value="${t.name}" id="${t.name}" style="width:20px;height:20px;" />\n                            </td>\n                            <td class="col-md-3 padding-bottom-fifteen padding-top-fifteen padding-left-zero padding-right-fifteen" >\n                                <label class="margin-zero cursor-pointer" for="${t.name}" style="width:100%">${t.name}</label>\n                            </td>\n                            <td class="col-md-2 padding-bottom-fifteen padding-top-fifteen padding-left-fifteen padding-right-fifteen" >\n                                <label class="margin-zero cursor-pointer" for="${t.name}" style="width:100%">${o}</label>\n                            </td>\n                        </tr>`;i+=a})),t.innerHTML=`<p style="font-weight: 700;color: var(--c-info);margin-left: 50px;">Group Name</p><table style="border: 0.5px solid var(--c-gray3);"><tbody>${i}</tbody></table>`,this.updateContentState("list-printed")}static _addListeners(e,t){let i=this.dialogContainer.querySelector(".close-modal"),n=this.dialogContainer.querySelector(".cancel-modal"),o=this.dialogContainer.querySelector(".submit-modal");i.addEventListener("click",(()=>{this.hide()})),n.addEventListener("click",(()=>{this.hide()})),o.addEventListener("submit",(i=>{i.preventDefault();let n=i.target["selected-reaction-group"];n=n&&n.length?Array.from(n):[n];let o=n.find((e=>e.checked)),s="",a={};o?(s=o.value,a=e.find((e=>e.name===s))):(s=e[0].name,a=e[0].reactions),a.value=a.name,t(null,a),this.hide()}))}}return e})();