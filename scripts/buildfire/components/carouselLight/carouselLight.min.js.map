{"version":3,"sources":["scripts/buildfire/components/carouselLight/carouselLight.js"],"names":["buildfire","components","carousel","scripts","document","getElementsByTagName","carouselScriptSrc","i","length","src","toLowerCase","indexOf","lory","write","style","getElementById","head","removeChild","createElement","id","innerHTML","appendChild","view","options","items","this","config","mergeSettings","_initDimensions","layout","init","selector","img","setAttribute","imageLib","cropImage","iconUrl","width","window","innerWidth","height","Math","ceil","alt","addEventListener","actionItems","execute","carouselImages","err","result","console","warn","display","prototype","settings","speed","loop","autoInterval","userSttings","attrname","validateLauncherCarousel","getContext","device","platform","navigation","onAppLauncherActive","self","_applySlider","onAppLauncherInactive","_destroySlider","querySelector","_renderHTMLItems","lorySlider","destroy","timerInterval","clearInterval","classNameSlideContainer","classNameFrame","ease","rewindSpeed","slideSpeed","slidesToScroll","infinite","enableMouseEvents","setInterval","next","callback","firstChild","sliderFrame","forEach","cname","classList","add","slideContainer","_loadImages","itemsLength","pending","_appendItem","itemSlide","item","slide","local","log","image","append","Array","push","innerHeight","cssWidth","cssHeight","_minHeight"],"mappings":"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","file":"carouselLight.min.js","sourcesContent":["'use strict';\n\nif (typeof (buildfire) == \"undefined\") throw (\"please add buildfire.js first to use carousel components\");\n\nif (typeof (buildfire.components) == \"undefined\")\n    buildfire.components = {};\n\nif (typeof (buildfire.components.carousel) == \"undefined\")\n    buildfire.components.carousel = {};\n\n(function () {\n    var scripts = document.getElementsByTagName('script');\n    var carouselScriptSrc = null;\n\n    for (var i = 0; i < scripts.length; i++) {\n        if (scripts[i].src && (scripts[i].src.toLowerCase().indexOf('buildfire/components/carousellight/carousellight.js') || scripts[i].src.toLowerCase().indexOf('buildfire/components/carousellight/carousellight.min.js'))) {\n            carouselScriptSrc = scripts[i].src;\n        }\n    }\n\n    if (carouselScriptSrc) {\n        if (typeof lory == 'undefined') {\n            document.write('<script src=\"' + carouselScriptSrc + '/../../../../lory/lory.min.js\"></script>');\n        }\n\n        //Add Lory CSS\n        var style = document.getElementById(\"loryInjectedStyle\");\n        if (style) document.head.removeChild(style);\n\n        style = document.createElement('style');\n        style.id = \"loryInjectedStyle\";\n        style.innerHTML += \" .loryFrame {position: relative;font-size: 0; line-height: 0; overflow: hidden; white-space: nowrap;}\";\n        style.innerHTML += \" .loryFrame li { position: relative; display: inline-block; height: 100%;}\";\n        style.innerHTML += \" .lorySlides { display: inline-block;}\";\n        style.innerHTML += \" .loryPercentage .lorySlides { display: block; padding: 0px;}\";\n        style.innerHTML += \" .loryPercentage li {  width: 100%;}\";\n\n        if (style.innerHTML.length > 0)\n            document.head.appendChild(style);\n        //# Add Lory CSS\n    }\n    else {\n        throw (\"carousellight components not found\");\n    }\n})();\n\n// This is the class that will be used in the mobile\n//{selector:selector, items:items, layout:layout, speed:speed}\nbuildfire.components.carousel.view = function (options) {\n    if ( options.items && options.items.length > 0) {\n        /*\n         if more than one image add carousel else add image directly to the carousel container\n         */\n        if (options.items.length > 1) {\n            this.config = this.mergeSettings(options);\n            this._initDimensions(this.config.layout);\n            this.init();\n        } else {\n            //add image directly to carousel container without adding the carousel lib\n            options.selector.innerHTML = '';\n            //append image tag\n            var img = document.createElement('img');\n            img.setAttribute(\"src\", buildfire.imageLib.cropImage(options.items[0].iconUrl, {\n                width: window.innerWidth,\n                height: Math.ceil(9 * (window.innerWidth) / 16)\n            }));\n            img.alt = \"Carousel Image\";\n            options.selector.appendChild(img);\n            img.addEventListener(\"click\", function () {\n                buildfire.actionItems.execute(carouselImages[0], function (err, result) {\n                    if (err) {\n                        console.warn('Error openning slider action: ', err);\n                    }\n                });\n            });\n        }\n        options.selector.style.display=\"\";\n    } else {\n        options.selector.style.display=\"none\";\n    }\n\n};\n\n// Carousel view methods\nbuildfire.components.carousel.view.prototype = {\n    mergeSettings: function (options) {\n        var settings = {\n            selector: '.js_percentage',\n            items: [],\n            layout: null,\n            speed: 200,\n            loop: true,\n            autoInterval: 5 * 1000\n        };\n        var userSttings = options;\n        for (var attrname in userSttings) {\n            settings[attrname] = userSttings[attrname];\n        }\n        return settings;\n    },\n    init: function () {\n        this.selector = typeof this.config.selector === 'string' ? document.querySelector(this.config.selector) : this.config.selector;\n\n        if (!this.selector) {\n            throw (\"selecter not found\");\n            return;\n        }\n\n        var self = this;\n\n        function validateLauncherCarousel() {\n            buildfire.getContext(function (err, result) {\n                if (result && result.device && result.device.platform && result.device.platform.toLowerCase() == 'ios') {\n                    buildfire.navigation.onAppLauncherActive(function () {\n                        self._applySlider();\n                    }, true);\n                    buildfire.navigation.onAppLauncherInactive(function () {\n                        self._destroySlider();\n                    }, true);\n                }\n            });\n        }\n\n        if (this.config.items && this.config.items.length > 0) {\n            this._renderHTMLItems(function () {\n                self._applySlider();\n                validateLauncherCarousel();\n            });\n        } else {\n            self._applySlider();\n            validateLauncherCarousel();\n        }\n    },\n    _destroySlider: function () {\n        this.lorySlider.destroy();\n        if (this.timerInterval) {\n            clearInterval(this.timerInterval);\n            this.timerInterval = null;\n        }\n    },\n    _applySlider: function () {\n        this.lorySlider = lory(this.config.selector, {\n            classNameSlideContainer: this.config.classNameSlideContainer || \"js_slides\",\n            classNameFrame: this.config.classNameFrame || 'js_frame',\n            ease: 'ease',\n            rewindSpeed: 600,//ms\n            slideSpeed: this.config.speed,//ms\n            slidesToScroll: this.config.slidesToScroll || 1,\n            infinite: this.config.infinite || 1,\n            enableMouseEvents: true\n        });\n\n        if (this.config.loop && this.config.items && this.config.items.length > 1) {\n            var self = this;\n\n            if (this.timerInterval) {\n                clearInterval(this.timerInterval);\n                this.timerInterval = null;\n            }\n\n            this.timerInterval = setInterval(function () {\n                self.lorySlider.next();\n            }, this.config.autoInterval);\n        }\n    },\n    _renderHTMLItems: function (callback) {\n        var self = this;\n\n        while (this.selector.firstChild) {\n            this.selector.removeChild(this.selector.firstChild);\n        }\n\n        this.sliderFrame = document.createElement('div');\n        ['loryFrame', 'js_frame'].forEach(function (cname) {\n            self.sliderFrame.classList.add(cname);\n        });\n\n        this.slideContainer = document.createElement('ul');\n        ['lorySlides', 'js_slides'].forEach(function (cname) {\n            self.slideContainer.classList.add(cname);\n        });\n\n        this._loadImages(this.config.items, function () {\n            ['slider', 'js_percentage', 'loryPercentage'].forEach(function (cname) {\n                self.selector.classList.add(cname);\n            });\n\n            self.sliderFrame.appendChild(self.slideContainer);\n            self.selector.appendChild(self.sliderFrame);\n\n            callback();\n        });\n    },\n    _loadImages: function (items, callback) {\n        var self = this;\n\n        var itemsLength = items.length;\n        var pending = itemsLength;\n\n        if (itemsLength == 0) {\n            callback();\n        }\n\n        for (var i = 0; i < itemsLength; i++) {\n            this._appendItem(items[i], function (itemSlide) {\n                pending--;\n                self.slideContainer.appendChild(itemSlide);\n\n                if (pending == 0) {\n                    callback();\n                }\n            });\n        }\n    },\n    _appendItem: function (item, callback) {\n        var slide = document.createElement(\"li\");\n        slide.classList.add('js_slide');\n\n        slide.addEventListener(\"click\", function () {\n            buildfire.actionItems.execute(item, function (err, result) {\n                if (err) {\n                    console.warn('Error openning slider action: ', err);\n                }\n            });\n        });\n\n        buildfire.imageLib.local.cropImage(item.iconUrl, {\n            width: this.width,\n            height: this.height\n        }, function (err, result) {\n            if (!err) {\n                var image = document.createElement(\"img\");\n                image.src = result;\n                slide.appendChild(image);\n            }\n            else\n                console.log('Error occurred while cropping image: ', err);\n\n            callback(slide);\n        });\n    },\n    // allows you to append a single item or an array of items\n    append: function (items) {\n        if (!items)\n            return;\n        else if (!(items instanceof Array) && typeof(items) == \"object\")\n            items = [items];\n\n        if (items && items instanceof Array && items.length) {\n            for (var i = 0; i < items.length; i++) {\n                this.items.push(items[i]);\n            }\n\n            var self = this;\n            this._loadImages(items, function () {\n                self._applySlider();\n            });\n        }\n    },\n    _initDimensions: function (layout) {\n        this.width = window.innerWidth;\n        layout = layout || \"WideScreen\";\n        if (layout == \"WideScreen\") {\n            this.height = Math.ceil(9 * this.width / 16);\n        } else if (layout == \"Square\") {\n            this.height = this.width;\n        } else if (layout == \"Cinema\") {\n            this.height = Math.ceil(1 * this.width / 2.39);\n        } else if (layout == \"MobileScreen\") {\n            this.height = (window.innerHeight / this.width) * this.width;\n            this.width = this.width;\n        }\n\n        this.cssWidth = this.width + \"px\";\n        if (this.height > 380) {\n            this.cssHeight = '380px';\n        } else {\n            this.cssHeight = this.height + \"px\";\n        }\n\n        // Set Min height on carousel so doesn't push content down on load.\n        this._minHeight = '180px';\n        this._minHeight = this.cssHeight;\n    }\n};"]}