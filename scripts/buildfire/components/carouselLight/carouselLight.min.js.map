{"version":3,"sources":["../sdk/scripts/buildfire/components/carouselLight/carouselLight.js"],"names":["buildfire","components","carousel","scripts","document","getElementsByTagName","carouselScriptSrc","i","length","src","toLowerCase","indexOf","lory","write","style","getElementById","head","removeChild","createElement","id","innerHTML","appendChild","view","options","img","items","this","config","mergeSettings","_initDimensions","layout","init","selector","setAttribute","imageLib","cropImage","iconUrl","size","aspect","width","window","innerWidth","height","Math","ceil","alt","title","addEventListener","actionItems","execute","err","result","console","warn","display","prototype","attrname","settings","speed","loop","autoInterval","userSttings","querySelector","self","validateLauncherCarousel","getContext","device","platform","getFrameType","navigation","onAppLauncherActive","_applySlider","onAppLauncherInactive","_destroySlider","_renderHTMLItems","timerInterval","clearInterval","lorySlider","classNameSlideContainer","classNameFrame","ease","rewindSpeed","slideSpeed","slidesToScroll","infinite","enableMouseEvents","setInterval","next","callback","firstChild","sliderFrame","forEach","cname","classList","add","slideContainer","_loadImages","itemsLength","pending","_appendItem","itemSlide","item","slide","local","log","image","append","Array","push","innerHeight","cssWidth","cssHeight","_minHeight"],"mappings":"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","file":"carouselLight.min.js","sourcesContent":["'use strict';\n\nif (typeof buildfire == 'undefined') throw 'please add buildfire.js first to use carousel components';\nif (typeof buildfire.components == 'undefined') buildfire.components = {};\nif (typeof buildfire.components.carousel == 'undefined') buildfire.components.carousel = {};\n\n(function () {\n  var scripts = document.getElementsByTagName('script');\n  var carouselScriptSrc = null;\n\n  for (var i = 0; i < scripts.length; i++) {\n    if (scripts[i].src && (scripts[i].src.toLowerCase().indexOf('buildfire/components/carousellight/carousellight.js') || scripts[i].src.toLowerCase().indexOf('buildfire/components/carousellight/carousellight.min.js'))) {\n      carouselScriptSrc = scripts[i].src;\n    }\n  }\n\n  if (carouselScriptSrc) {\n    if (typeof lory == 'undefined') {\n      document.write('<script src=\"' + carouselScriptSrc + '/../../../../lory/lory.min.js\"></script>');\n    } //Add Lory CSS\n\n\n    var style = document.getElementById('loryInjectedStyle');\n    if (style) document.head.removeChild(style);\n    style = document.createElement('style');\n    style.id = 'loryInjectedStyle';\n    style.innerHTML += ' .loryFrame {position: relative;font-size: 0; line-height: 0; overflow: hidden; white-space: nowrap;}';\n    style.innerHTML += ' .loryFrame li { position: relative; display: inline-block; height: 100%;}';\n    style.innerHTML += ' .lorySlides { display: inline-block;}';\n    style.innerHTML += ' .loryPercentage .lorySlides { display: block; padding: 0px;}';\n    style.innerHTML += ' .loryPercentage li {  width: 100%;}';\n    if (style.innerHTML.length > 0) document.head.appendChild(style); //# Add Lory CSS\n  } else {\n    throw 'carousellight components not found';\n  }\n})(); // This is the class that will be used in the mobile\n//{selector:selector, items:items, layout:layout, speed:speed}\n\n\nbuildfire.components.carousel.view = function (options) {\n  if (options.items && options.items.length > 0) {\n    /*\n           if more than one image add carousel else add image directly to the carousel container\n           */\n    if (options.items.length > 1) {\n      this.config = this.mergeSettings(options);\n\n      this._initDimensions(this.config.layout);\n\n      this.init();\n    } else {\n      //add image directly to carousel container without adding the carousel lib\n      options.selector.innerHTML = ''; //append image tag\n\n      var img = document.createElement('img');\n      img.setAttribute(\"src\", buildfire.imageLib.cropImage(options.items[0].iconUrl, {\n        size: 'full_width',\n        aspect: '16:9',\n        width: window.innerWidth,\n        height: Math.ceil(9 * window.innerWidth / 16)\n      }));\n      img.alt = options.items[0].title;\n      options.selector.appendChild(img);\n      img.addEventListener(\"click\", function () {\n        buildfire.actionItems.execute(options.items[0], function (err, result) {\n          if (err) {\n            console.warn('Error openning slider action: ', err);\n          }\n        });\n      });\n    }\n\n    options.selector.style.display = \"\";\n  } else {\n    options.selector.style.display = \"none\";\n  }\n}; // Carousel view methods\n\n\nbuildfire.components.carousel.view.prototype = {\n  mergeSettings: function (options) {\n    var settings = {\n      selector: '.js_percentage',\n      items: [],\n      layout: null,\n      speed: 200,\n      loop: true,\n      autoInterval: 5 * 1000\n    };\n    var userSttings = options;\n\n    for (var attrname in userSttings) {\n      settings[attrname] = userSttings[attrname];\n    }\n\n    return settings;\n  },\n  init: function () {\n    this.selector = typeof this.config.selector === 'string' ? document.querySelector(this.config.selector) : this.config.selector;\n\n    if (!this.selector) {\n      throw 'selecter not found';\n      return;\n    }\n\n    var self = this;\n\n    function validateLauncherCarousel() {\n      buildfire.getContext(function (err, result) {\n        if (result && result.device && result.device.platform && result.device.platform.toLowerCase() == 'ios' && buildfire.getFrameType() == 'LAUNCHER_PLUGIN') {\n          buildfire.navigation.onAppLauncherActive(function () {\n            self._applySlider();\n          }, true);\n          buildfire.navigation.onAppLauncherInactive(function () {\n            self._destroySlider();\n          }, true);\n        }\n      });\n    }\n\n    if (this.config.items && this.config.items.length > 0) {\n      this._renderHTMLItems(function () {\n        self._applySlider();\n\n        validateLauncherCarousel();\n      });\n    } else {\n      self._applySlider();\n\n      validateLauncherCarousel();\n    }\n  },\n  _destroySlider: function () {\n    if (this.timerInterval) {\n      clearInterval(this.timerInterval);\n      this.timerInterval = null;\n    }\n  },\n  _applySlider: function () {\n    if (!this.lorySlider) {\n      this.lorySlider = lory(this.config.selector, {\n        classNameSlideContainer: this.config.classNameSlideContainer || 'js_slides',\n        classNameFrame: this.config.classNameFrame || 'js_frame',\n        ease: 'ease',\n        rewindSpeed: 600,\n        //ms\n        slideSpeed: this.config.speed,\n        //ms\n        slidesToScroll: this.config.slidesToScroll || 1,\n        infinite: this.config.infinite || 1,\n        enableMouseEvents: true\n      });\n    }\n\n    if (this.config.loop && this.config.items && this.config.items.length > 1) {\n      var self = this;\n\n      if (this.timerInterval) {\n        clearInterval(this.timerInterval);\n        this.timerInterval = null;\n      }\n\n      this.timerInterval = setInterval(function () {\n        self.lorySlider.next();\n      }, this.config.autoInterval);\n    }\n  },\n  _renderHTMLItems: function (callback) {\n    var self = this;\n\n    while (this.selector.firstChild) {\n      this.selector.removeChild(this.selector.firstChild);\n    }\n\n    this.sliderFrame = document.createElement('div');\n    ['loryFrame', 'js_frame'].forEach(function (cname) {\n      self.sliderFrame.classList.add(cname);\n    });\n    this.slideContainer = document.createElement('ul');\n    ['lorySlides', 'js_slides'].forEach(function (cname) {\n      self.slideContainer.classList.add(cname);\n    });\n\n    this._loadImages(this.config.items, function () {\n      ['slider', 'js_percentage', 'loryPercentage'].forEach(function (cname) {\n        self.selector.classList.add(cname);\n      });\n      self.sliderFrame.appendChild(self.slideContainer);\n      self.selector.appendChild(self.sliderFrame);\n      callback();\n    });\n  },\n  _loadImages: function (items, callback) {\n    var self = this;\n    var itemsLength = items.length;\n    var pending = itemsLength;\n\n    if (itemsLength == 0) {\n      callback();\n    }\n\n    for (var i = 0; i < itemsLength; i++) {\n      this._appendItem(items[i], function (itemSlide) {\n        pending--;\n        self.slideContainer.appendChild(itemSlide);\n\n        if (pending == 0) {\n          callback();\n        }\n      });\n    }\n  },\n  _appendItem: function (item, callback) {\n    var slide = document.createElement('li');\n    slide.classList.add('js_slide');\n    slide.addEventListener('click', function () {\n      buildfire.actionItems.execute(item, function (err, result) {\n        if (err) {\n          console.warn('Error openning slider action: ', err);\n        }\n      });\n    });\n    buildfire.imageLib.local.cropImage(item.iconUrl, {\n      aspect: this.aspect,\n      size: 'full_width',\n      width: this.width,\n      height: this.height\n    }, function (err, result) {\n      if (!err) {\n        var image = document.createElement(\"img\");\n        image.src = result;\n        image.alt = item.title || '';\n        slide.appendChild(image);\n      } else console.log('Error occurred while cropping image: ', err);\n\n      callback(slide);\n    });\n  },\n  // allows you to append a single item or an array of items\n  append: function (items) {\n    if (!items) return;else if (!(items instanceof Array) && typeof items == 'object') items = [items];\n\n    if (items && items instanceof Array && items.length) {\n      for (var i = 0; i < items.length; i++) {\n        this.items.push(items[i]);\n      }\n\n      var self = this;\n\n      this._loadImages(items, function () {\n        self._applySlider();\n      });\n    }\n  },\n  _initDimensions: function (layout) {\n    this.width = window.innerWidth;\n    layout = layout || 'WideScreen';\n\n    if (layout == 'WideScreen') {\n      this.height = Math.ceil(9 * this.width / 16);\n      this.aspect = '16:9';\n    } else if (layout == 'Square') {\n      this.height = this.width;\n      this.aspect = '1:1';\n    } else if (layout == 'Cinema') {\n      this.height = Math.ceil(1 * this.width / 2.39);\n      this.aspect = '2.39:1';\n    } else if (layout == 'MobileScreen') {\n      this.height = window.innerHeight / this.width * this.width;\n      this.width = this.width;\n      this.aspect = '9:16';\n    }\n\n    this.cssWidth = this.width + 'px';\n\n    if (this.height > 380) {\n      this.cssHeight = '380px';\n    } else {\n      this.cssHeight = this.height + 'px';\n    } // Set Min height on carousel so doesn't push content down on load.\n\n\n    this._minHeight = '180px';\n    this._minHeight = this.cssHeight;\n  }\n};"]}